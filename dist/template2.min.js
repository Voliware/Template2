Object.setProperties=function(e,t){for(let s in t)e.hasOwnProperty(s)&&(e[s]=t[s]);return e},Object.isEmpty=function(e){return!Object.keys(e).length},Object.extend=function(){for(let e=1;e<arguments.length;e++)for(let t in arguments[e])arguments[e].hasOwnProperty(t)&&("object"==typeof arguments[0][t]&&"object"==typeof arguments[e][t]?Object.extend(arguments[0][t],arguments[e][t]):arguments[0][t]=arguments[e][t]);return arguments[0]},Object.flatten=function(e){var t={};for(var s in e)if(e.hasOwnProperty(s))if("object"==typeof e[s]&&null!==e[s]){var r=Object.flatten(e[s]);for(var n in r)r.hasOwnProperty(n)&&(t[s+"."+n]=r[n])}else t[s]=e[s];return t},Object.unflatten=function(e){let t={};for(let s in e){let r=s.split(".");r.reduce(function(t,n,a){return t[n]||(t[n]=isNaN(Number(r[a+1]))?r.length-1==a?e[s]:{}:[])},t)}return t},String.random=function(e){for(var t,s="";s.length<e;)s+=(void 0,(t=Math.floor(62*Math.random()))<10?t:t<36?String.fromCharCode(t+55):String.fromCharCode(t+61));return s},document.getElementsByDataName=function(e){return document.querySelectorAll(`[data-name="${e}"]`)},document.getElementByDataName=function(e){let t=document.getElementsByDataName(e);return t.length?t[0]:null};class EventSystem{constructor(){return this.events={},this}getHandlersCount(e){let t=this.events[e];if(!t)return 0;let s=0,r=[];for(r.push(t);r.length>0;){let e=r.pop();for(let t in e)"_handlers"===t?s+=e[t].length:"object"==typeof e[t]&&r.push(e[t])}return s}on(e,t){let s=e.split("."),r=this.events;for(let e=0;e<s.length;e++){let n=s[e];r[n]||(r[n]={}),e===s.length-1?(Array.isArray(r[n]._handlers)||(r[n]._handlers=[]),r[n]._handlers.push(t)):r=r[n]}return this}one(e,t){let s=this,r=e+"."+String.random(8);return this.on(r,function(e){t(e),s.off(r)}),this}off(e,t=!0){let s=e.split("."),r=this.events;for(let e=0;e<s.length;e++){let n=s[e];e===s.length-1?t?delete r[n]:(delete r[n]._handlers,0===Object.keys(r[n]).length&&delete r[n]):r=r[n]}return this}emit(e,t){let s=e.split("."),r=this.events;for(let e=0;e<s.length;e++){if(!(r=r[s[e]]))return this;if(e===s.length-1){let e=[];for(e.push(r);e.length;){let s=e.pop();for(let r in s)if("_handlers"===r)for(let e=0;e<s[r].length;e++)s[r][e](t);else e.push(s[r])}}}return this}}class ElementManager extends EventSystem{constructor(e,t,s){super();return this.options=Object.extend({primaryKey:"id",maxElements:0,cloneTemplate:!0,removeTemplate:!0,removeDeadTemplates:!0},s),this.wrapper=e,this.template=this.options.cloneTemplate?t.cloneNode(!0):t,this.template.removeAttribute("id"),this.template.classList.remove("template"),this.elements=new Map,this.options.removeTemplate&&t.remove(),this.cachedData={},this.processedRenderData={},this}cacheData(e){return Object.extend({},e)}processRenderData(e){return e}empty(){for(;this.wrapper.firstChild;)this.wrapper.removeChild(this.wrapper.firstChild);return this.elements=new Map,this}attachElementHandlers(e){return this}cloneTemplate(){let e=this.template.cloneNode(!0);return this.attachElementHandlers(e),e}appendElement(e){return this.wrapper.appendChild(e),this}appendElementBefore(e,t){return t.before(e),this}appendElementAfter(e,t){return t.after(e),this}removeElement(e){let t=this.elements.get(e);return t&&(this.wrapper.removeChild(t),this.elements.delete(e)),this}removeDeadElements(e){for(let[t,s]of this.elements)this.getData(e,t)||(s.remove(),this.elements.delete(t));return this}getDataType(e){return e instanceof Map?"map":Array.isArray(e)?"array":"object"==typeof e?"object":null}getData(e,t){switch(this.getDataType(e)){case"array":let s=e.filter(function(e){return e.id===t});return s&&s.length?s[0]:null;case"map":return e.get(t);case"object":return e[t];default:return null}}render(e){switch(this.cachedData=this.cacheData(e),this.processedRenderData=this.processRenderData(e),this.getDataType(e)){case"array":this.renderArray(e);break;case"map":this.renderMap(e);break;default:case"object":this.renderObject(e)}return this.options.removeDeadTemplates&&this.removeDeadElements(e),this}renderArray(e){for(let t=0;t<e.length;t++){let s=e[t][this.options.primaryKey];if(void 0===s)return void console.error("ElementManager.renderArray: data must have a primary key property");this.renderElement(s,e[t],t)}return this}renderMap(e){let t=0;for(let[s,r]of e)this.renderElement(s,r,t),t++;return this}renderObject(e){let t=0;for(let s in e)this.renderElement(s,e[s],t),t++;return this}renderSingle(e,t){let s={};return s[e]=t,this.render(s),this}renderElement(e,t,s){let r=!1,n=this.elements.get(e);return n||(r=!0,n=this.cloneTemplate()),n&&(n instanceof Template?n.render(t):Template.render(n,t),r&&(this.elements.set(e,n),this.appendElement(n))),this}static dataArrayToDataObject(e,t="id"){let s={};for(let r=0;r<e.length;r++){let n=e[r][t];void 0===n?console.error(`dataArrayToDataObject: object does not have required "${t}" value`):s[n]=e[r]}return s}}const Status={none:"none",error:"error",success:"success",processing:"processing",info:"info",warning:"warning",class:{}};Status.class[Status.none]="status-none",Status.class[Status.error]="status-error",Status.class[Status.success]="status-success",Status.class[Status.processing]="status-processing",Status.class[Status.info]="status-info",Status.class[Status.warning]="status-warning",Status.classArray=[Status.class.none,Status.class.error,Status.class.success,Status.class.processing,Status.class.info,Status.class.warning],Status.bgclass={},Status.bgclass[Status.none]="status-bg-none",Status.bgclass[Status.error]="status-bg-error",Status.bgclass[Status.success]="status-bg-success",Status.bgclass[Status.processing]="status-bg-processing",Status.bgclass[Status.info]="status-bg-info",Status.bgclass[Status.warning]="status-bg-warning",Status.bgclassArray=[Status.bgclass.none,Status.bgclass.error,Status.bgclass.success,Status.bgclass.processing,Status.bgclass.info,Status.bgclass.warning],Status.icon={},Status.icon[Status.none]="",Status.icon[Status.error]="",Status.icon[Status.info]="",Status.icon[Status.processing]='<div class="spinner-container"><div class="spinner-wheel"></div></div>',Status.icon[Status.success]="",Status.icon[Status.warning]="";class Template extends HTMLElement{constructor(e={}){super();return this.options=Object.extend({elements:{},renderAttribute:"data-name",displayBlock:!0},e),this.eventSystem=new EventSystem,this.nativeEvents={},this.elements={},this.cachedData={},this.renderData={},this.isFirstRender=!0,this.observer=new MutationObserver(this.mutationObserverCallback.bind(this)),this.findNamedElements(),this.findElements(this.options.elements),this}mutationObserverCallback(e,t){e.forEach(e=>{switch(e.type){case"childList":case"subtree":return void console.debug("Mutated")}})}connectedCallback(){this.options.displayBlock&&this.classList.add("template-block"),this.attachHandlers()}attachHandlers(){return this}setOptions(e){for(let t in e)this.options.hasOwnProperty(t)&&(this.options[t]=e[t]);return this}static addEventSystem(e){e.eventSystem=new EventSystem,e.nativeEvents={}}static on(e,t,s){let r=t.split(".")[0];e.eventSystem||Template.addEventSystem(e),0===e.eventSystem.getHandlersCount(r)&&(e.nativeEvents[r]=function(t){e.eventSystem.emit(r,t)},e.addEventListener(r,e.nativeEvents[r])),e.eventSystem.on(t,s)}on(e,t){return Template.on(this,e,t),this}static one(e,t,s){let r=t.split(".")[0];e.eventSystem||Template.addEventSystem(e),0===e.eventSystem.getHandlersCount(r)&&(e.nativeEvents[r]=function(t){e.eventSystem.emit(r,t),e.removeEventListener(r,e.nativeEvents[r])},e.addEventListener(r,e.nativeEvents[r])),e.eventSystem.one(t,s)}one(e,t){return Template.one(this,e,t),this}static off(e,t,s=!0){if(!(e.eventSystem instanceof EventSystem))return;let r=t.split(".")[0];e.eventSystem.off(t,s),0===e.eventSystem.getHandlersCount(r)&&e.removeEventListener(r,e.nativeEvents[r])}off(e,t=!0){return Template.off(this,e,t),this}static emit(e,t,s){e.eventSystem instanceof EventSystem&&e.eventSystem.emit(t,s)}emit(e,t){return Template.emit(this,e,t),this}setAttributes(e){for(let t=0;t<e.length;t++){let s=e[t];this.setAttribute(s.name,s.value)}return this}findElements(e){for(let t in e)this.elements[t]=this.querySelector(e[t]);return this.elements}static findNamedElements(e){let t={},s=e.querySelectorAll("[name], [data-name]");for(let e=0;e<s.length;e++){let r=s[e].getAttribute("name");r||(r=s[e].getAttribute("data-name")),r&&(t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(s[e])):t[r]=s[e])}return t}findNamedElements(){let e=Template.findNamedElements(this);return Object.extend(this.elements,e),this}getElements(){return this.elements}static select(e,t){return"string"==typeof e&&(t=e,e=document.documentElement),e.querySelectorAll(t)}select(e){return Template.select(this,e)}static selectFirst(e,t){let s=Template.select(e,t);return s instanceof NodeList?s[0]:null}selectFirst(e){return Template.selectFirst(this,e)}static selectLast(e,t){let s=Template.select(e,t);return s instanceof NodeList?s[e.length-1]:null}selectLast(e){return Template.selectLast(e)}static append(e,t){t.appendChild(e)}append(e){return Template.append(e,this),this}appendTo(e){return Template.append(this,e),this}static prepend(e,t){t.insertBefore(e,t.firstChild)}prepend(e){return Template.prepend(e,this),this}prependTo(e){return Template.prepend(this,e),this}static empty(e){for(;this.element;)e.removeChild(e.firstChild)}empty(){return Template.empty(this),this}static isVisible(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}isVisible(){return Template.isVisible(this)}static hide(e){"none"!==e.style.display&&(e.previousDisplay=e.style.display),e.style.display="none"}hide(){return Template.hide(this),this}static show(e){e.style.display=e.previousDisplay||"block"}show(){return Template.show(this),this}static display(e,t){return void 0===t&&(t=!Template.isVisible(e)),t?Template.show(e):Template.hide(e)}display(e){return Template.display(this,e),this}static getStyle(e,t){return window.getComputedStyle(e).getPropertyValue(t)}getStyle(e){return Template.getStyle(this,e)}static setHeight(e,t){e.style.height=t+"px"}setHeight(e){return Template.setHeight(this,e),this}static setWidth(e,t){e.style.width=t+"px"}setWidth(e){return Template.setWidth(this,e),this}static addClass(e,t){e.classList.add(t)}addClass(e){return Template.addClass(this,e),this}static hasClass(e,t){return e.classList.contains(t)}hasClass(e){return Template.hasClass(this,e)}static removeClass(e,t){e.classList.remove(t)}removeClass(e){return Template.removeClass(this,e),this}static replaceClass(e,t,s){e.classList.replace(t,s)}replaceClass(e,t){return Template.replaceClass(this,e,t),this}static toggleClass(e,t,s){e.classList.toggle(t,s)}toggleClass(e,t){return Template.toggleClass(this,e,t),this}static getValue(e){return e.value}getValue(){return Template.getValue(this)}static setValue(e,t){e.value=t}setValue(e){return Template.setValue(this,e),this}static enable(e){e.disabled=!1}enable(){return Template.enable(this),this}static disable(e){e.disabled=!0}disable(){return Template.disable(this),this}cacheData(e){return this.cachedData=Object.extend({},e)}processRenderData(e){return this.renderData=e}static render(e,t,s=!1){let r=null;r=s?e.getElements():Template.findNamedElements(e);let n=Object.flatten(t);for(let e in n){let t=n[e],s=r[e];if(s)if(s.render)s.render(t);else{Array.isArray(s)||(s=[s]);for(let e=0;e<s.length;e++){let r=s[e];if("false"!==r.getAttribute("data-render"))if("INPUT"===r.tagName){let e=r.getAttribute("type");e&&("checkbox"===e&&t?r.checked=!0:"radio"===e?r.getAttribute("value")===t&&(r.checked=!0):r.value=t)}else"SELECT"===r.tagName?r.value=t:r.innerHTML=t}}}}render(e){return this.cachedData=this.cacheData(e),this.renderData=this.processRenderData(Object.extend({},e)),this.observer.observe(this,{childList:!0,subtree:!0}),Template.render(this,this.renderData,!0),this.observer.disconnect(),this.isFirstRender=!1,this}}customElements.define("template-element",Template);